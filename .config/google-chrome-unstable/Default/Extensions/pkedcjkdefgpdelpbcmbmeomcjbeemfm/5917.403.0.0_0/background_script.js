'use strict';var GD=/^([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/,HD=[4278190080,4293918720,4294901760],ID=[167772160,2886729728,3232235520],JD=function(a){var b=document.createElement("a");b.href=a;return b};var KD=function(a,b,c){this.f=a;this.g=b;this.h=c;this.a=0;this.b=[]};KD.prototype.send=function(a,b,c,d){var e=void 0===d?{}:d;d=void 0===e.timeoutMillis?this.g:e.timeoutMillis;e=void 0===e.qh?this.h:e.qh;a={ra:new Nc,url:a,method:b,body:c,timeoutMillis:d,rh:e};this.a<this.f?LD(this,a):this.b.push(a);return a.ra.a};
var MD=function(a){if(0<a.b.length&&a.a<a.f){var b=a.b.shift();LD(a,b)}},LD=function(a,b){a.a++;b.rh--;ND(b).then(function(c){b.ra.resolve(c);a.a--;MD(a)},function(c){0==b.rh?b.ra.b(c):a.b.push(b);a.a--;MD(a)})},ND=function(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){d.readyState==XMLHttpRequest.DONE&&b(d)};d.timeout=a.timeoutMillis;d.ontimeout=function(){c(Error("Timed out"))};d.open(a.method,a.url,!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
d.send(a.body)})};var OD=function(){this.name="unknown";this.state="error";this.a=null;this.allowStop=!0;this.Uc=null;this.extraData={}},PD=function(){var a;a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};ka(PD,Error);var RD=function(a,b){void 0===b&&(QD||(QD=new KD(10,2E3,1)),b=QD);this.b=a;this.a=b;this.l=v("mr.dial.Client")};RD.prototype.launchApp=function(a,b){var c=this;return this.a.send(SD(this,a),"POST",b,{timeoutMillis:15E3}).then(function(a){return TD(c,"launchApp","POST",a)})};
var UD=function(a,b){return a.a.send(SD(a,b),"DELETE").then(function(b){return TD(a,"stopApp","DELETE",b)})},VD=function(a,b){return a.a.send(SD(a,b),"GET",void 0,{qh:3}).then(function(c){Ze(a.l,"GetAppInfo","GET",c);if(!(200<=c.status&&299>=c.status)){if(404==c.status)throw new PD;throw Error("Response error: "+c.status);}c=$e(c.responseText);if(!c)throw x(a.l,"Invalid or empty response"),Error("Invalid or empty response");var d=c.getElementsByTagName("service");if(!d||1!=d.length)throw x(a.l,"Invalid GET response (invalid service)"),
Error("Invalid GET response (invalid service)");c=new OD;for(var e=0,f=d[0].childNodes.length;e<f;e++){var g=d[0].childNodes[e];if("state"==g.nodeName){a:switch(g.textContent){case "running":g="running";break a;case "stopped":g="stopped";break a;default:g="error"}c.state=g}else"name"==g.nodeName?c.name=g.textContent:"link"==g.nodeName?c.Uc=g.getAttribute("href"):"options"==g.nodeName?c.allowStop="false"!=g.getAttribute("allowStop"):c.extraData[g.nodeName]=g.innerHTML}if("unknown"==c.name)throw x(a.l,
"GET response missing name value"),Error("GET response missing name value");if(c.name!=b)throw x(a.l,"GET app name mismatch"),Error("GET app name mismatch");if("error"==c.state)throw x(a.l,"GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(c.state))&&d[1])c.state="installable",c.a=d[1];else if("running"!=c.state&&"stopped"!=c.state)throw x(a.l,"GET response has invalid state value"),Error("GET response has invalid state value");return c})},
SD=function(a,b){a=a.b.Sb;"/"!=a.charAt(a.length-1)&&(a+="/");return a+b},TD=function(a,b,c,d){return new Promise(function(e,f){Ze(a.l,b,c,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},QD=null;var WD=function(a,b){this.appName=a;this.launchParameter=void 0===b?"":b},YD=function(a){if(a.startsWith("urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new WD(c,0<b?a.substring(b+1):void 0):null}else a=XD(a);return a},XD=function(a){var b=(new im(a)).f;if(!b)return null;a=(a=ZD.exec(b))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(b=(b=$D.exec(b))?b[1]:void 0)try{b=hk(b)}catch(c){return w(aE,"Invalid base64 encoded postData:"+
b),null}return new WD(a,b)},aE=v("mr.dial.MediaSource"),ZD=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,$D=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var bE=function(a,b){this.qb=a;this.appName=b};var cE=function(a){this.a=new Map;this.b=a};cE.prototype.init=function(){rj(this)};cE.prototype.clear=function(){this.a.clear()};cE.prototype.add=function(a){if(!this.a.get(a.qb.id)){this.a.set(a.qb.id,a);var b=this.b;dE(b);b.h.kc(b,a.qb)}};var eE=function(a,b){a=ja(a.a);for(var c=a.next();!c.done;c=a.next())if(c=ja(c.value),c.next(),c=c.next().value,c.qb.sinkId==b)return c;return null},gE=function(a,b){var c=a.a.get(b);c&&(a.a.delete(b),fE(a.b,c))},hE=function(a){return Array.from(a.a.values(),function(a){return a.qb})};
cE.prototype.fa=function(){return"dial.ActivityRecords"};cE.prototype.qa=function(){return[Array.from(this.a)]};cE.prototype.va=function(){var a=oj(this);a&&(this.a=new Map(a))};var iE={xn:0,kq:1,kp:2,wn:3},jE={ERROR:0,Cp:1,EMPTY:2},kE=function(a){ai("MediaRouter.Dial.Create.Route",a,iE)},lE=function(a){ai("MediaRouter.Dial.Device.Description.Failure",a,jE)};var mE=function(a,b){this.a=a;this.b=b};mE.prototype.clone=function(){return new mE(this.a,this.b)};var nE=function(a){this.a=[];if(a)a:{var b;if(a instanceof nE){if(b=a.Ea(),a=a.P(),0>=this.Y()){for(var c=this.a,d=0;d<b.length;d++)c.push(new mE(b[d],a[d]));break a}}else b=La(a),a=Ka(a);for(d=0;d<b.length;d++)this.insert(b[d],a[d])}};h=nE.prototype;h.insert=function(a,b){var c=this.a;c.push(new mE(a,b));a=c.length-1;b=this.a;for(c=b[a];0<a;){var d=a-1>>1;if(b[d].a>c.a)b[a]=b[d],a=d;else break}b[a]=c};
h.remove=function(){var a=this.a,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Mb(a);else{a[0]=a.pop();for(var a=0,b=this.a,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,g=2*a+2,f=g<d&&b[g].a<b[f].a?g:f;if(b[f].a>e.a)break;b[a]=b[f];a=f}b[a]=e}return c.b}};h.P=function(){for(var a=this.a,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].b);return b};h.Ea=function(){for(var a=this.a,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].a);return b};h.Ac=function(a){return Fb(this.a,function(b){return b.b==a})};
h.Oa=function(a){return Fb(this.a,function(b){return b.a==a})};h.clone=function(){return new nE(this)};h.Y=function(){return this.a.length};h.Ra=function(){return Lb(this.a)};h.clear=function(){Mb(this.a)};var oE=function(){nE.call(this)};r(oE,nE);var pE=function(a,b){dd.call(this);this.v=a||0;this.f=b||10;if(this.v>this.f)throw Error("[goog.structs.Pool] Min can not be greater than max");this.a=new Gr;this.b=new mf;this.m=null;this.Ud()};r(pE,dd);pE.prototype.ke=function(){var a=Ea();if(!(null!=this.m&&0>a-this.m)){for(var b;0<this.a.Y()&&(b=Hr(this.a),!this.pf(b));)this.Ud();!b&&this.Y()<this.f&&(b=this.j());b&&(this.m=a,this.b.add(b));return b}};pE.prototype.fd=function(a){this.b.remove(a);this.pf(a)&&this.Y()<this.f?this.a.a.push(a):qE(a)};
pE.prototype.Ud=function(){for(var a=this.a;this.Y()<this.v;){var b=this.j();a.a.push(b)}for(;this.Y()>this.f&&0<this.a.Y();)qE(Hr(a))};pE.prototype.j=function(){return{}};var qE=function(a){if("function"==typeof a.pa)a.pa();else for(var b in a)a[b]=null};h=pE.prototype;h.pf=function(a){return"function"==typeof a.Xj?a.Xj():!0};h.contains=function(a){return this.a.contains(a)||this.b.contains(a)};h.Y=function(){return this.a.Y()+this.b.Y()};h.Ra=function(){return this.a.Ra()&&this.b.Ra()};
h.T=function(){pE.S.T.call(this);if(0<this.b.Y())throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var a=this.a;!a.Ra();)qE(Hr(a));delete this.a};var rE=function(a,b){this.g=new oE;pE.call(this,a,b)};r(rE,pE);h=rE.prototype;h.ke=function(a,b){if(!a)return rE.S.ke.call(this);this.g.insert(k(b)?b:100,a);this.hf()};h.hf=function(){for(var a=this.g;0<a.Y();){var b=this.ke();if(b)a.remove().apply(this,[b]);else break}};h.fd=function(a){rE.S.fd.call(this,a);this.hf()};h.Ud=function(){rE.S.Ud.call(this);this.hf()};h.T=function(){rE.S.T.call(this);na.clearTimeout(void 0);this.g.clear();this.g=null};var sE=function(a,b,c,d){this.o=a;this.u=!!d;rE.call(this,b,c)};r(sE,rE);sE.prototype.j=function(){var a=new Mf,b=this.o;b&&b.forEach(function(b,d){a.headers.set(d,b)});this.u&&(a.A=!0);return a};sE.prototype.pf=function(a){return!a.w&&!a.a};var tE=function(a,b,c,d,e,f){B.call(this);this.g=k(a)?a:1;this.j=k(e)?Math.max(0,e):0;this.m=!!f;this.b=new sE(b,c,d,f);this.a=new C;this.f=new Xt(this)};r(tE,B);var uE="ready complete success error abort timeout".split(" ");tE.prototype.send=function(a,b,c,d,e,f,g,m,q,y){if(this.a.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new vE(b,n(this.u,this,a),c,d,e,g,k(m)?m:this.g,q,k(y)?y:this.m);this.a.set(a,b);a=n(this.o,this,a);this.b.ke(a,f);return b};
tE.prototype.abort=function(a,b){var c=this.a.get(a);if(c){var d=c.Ge;c.tg=!0;b&&(d&&(this.f.v(d,uE,c.Tf),qe(d,"ready",function(){var a=this.b;a.b.remove(d)&&a.fd(d)},!1,this)),this.a.remove(a));d&&d.abort()}};tE.prototype.o=function(a,b){var c=this.a.get(a);c&&!c.Ge?(this.f.listen(b,uE,c.Tf),b.f=Math.max(0,this.j),b.j=c.cf(),b.A=c.dh(),c.Ge=b,this.dispatchEvent(new wE("ready",this,a,b)),xE(this,a,b),c.tg&&b.abort()):(a=this.b,a.b.remove(b)&&a.fd(b))};
tE.prototype.u=function(a,b){var c=b.target;switch(b.type){case "ready":xE(this,a,c);break;case "complete":a:{var d=this.a.get(a);if(7==c.o||We(c)||d.Wd>d.gf)if(this.dispatchEvent(new wE("complete",this,a,c)),d&&(d.Gg=!0,d.Fg)){a=d.Fg.call(c,b);break a}a=null}return a;case "success":this.dispatchEvent(new wE("success",this,a,c));break;case "timeout":case "error":b=this.a.get(a);b.Wd>b.gf&&this.dispatchEvent(new wE("error",this,a,c));break;case "abort":this.dispatchEvent(new wE("abort",this,a,c))}return null};
var xE=function(a,b,c){var d=a.a.get(b);!d||d.Gg||d.Wd>d.gf?(d&&(a.f.v(c,uE,d.Tf),a.a.remove(b)),a=a.b,a.b.remove(c)&&a.fd(c)):(d.Wd++,c.send(d.getUrl(),d.xk,d.fb(),d.qd()))};tE.prototype.T=function(){tE.S.T.call(this);this.b.pa();this.b=null;this.f.pa();this.f=null;this.a.clear();this.a=null};var wE=function(a,b,c,d){A.call(this,a,b);this.id=c;this.Ge=d};r(wE,A);
var vE=function(a,b,c,d,e,f,g,m,q){this.h=a;this.xk=c||"GET";this.a=d;this.b=e||null;this.gf=k(g)?g:1;this.Wd=0;this.tg=this.Gg=!1;this.Tf=b;this.Fg=f;this.f=m||"";this.g=!!q;this.Ge=null};h=vE.prototype;h.getUrl=function(){return this.h};h.fb=function(){return this.a};h.qd=function(){return this.b};h.dh=function(){return this.g};h.cf=function(){return this.f};var yE=function(){this.a=this.modelName=this.deviceType=this.expireTimeMillis=this.fetchTimeMillis=this.appUrl=this.ipAddress=this.friendlyName=this.deviceLabel=this.uniqueId=null},zE=function(a){var b;a.deviceLabel?a.uniqueId?a.friendlyName?a.ipAddress?a.appUrl?a.fetchTimeMillis?a.expireTimeMillis?(b=a.ipAddress,a=JD(a.appUrl),b="http:"==a.protocol&&a.hostname==b?null:"Invalid appUrl"):b="Missing expireTimeMillis":b="Missing fetchTimeMillis":b="Missing appUrl":b="Missing ipAddress":b="Missing friendlyName":
b="Missing uniqueId":b="Missing deviceLabel";return b};yE.prototype.toString=function(){return JSON.stringify(this,function(a,b){return va(b)&&0==b.indexOf("uuid:")?"***":b})};
var AE=function(a){var b=new yE;b.uniqueId=a.uniqueId;b.deviceLabel=a.deviceLabel;b.friendlyName=a.friendlyName;b.ipAddress=a.ipAddress;b.appUrl=a.appUrl;b.fetchTimeMillis=a.fetchTimeMillis;b.expireTimeMillis=a.expireTimeMillis;b.deviceType=a.deviceType;b.modelName=a.modelName;b.a=a.configId;return b},DE=function(a){this.a=new Map;this.b=new Map;this.f=new Map;var b;(b=a)||(BE||(BE=new tE(3,null,1,10,2E3)),b=BE);this.h=b;a||(CE||(CE=new tE(2,null,1,10,3E3)),a=CE);this.g=a;this.l=v("mr.dial.DeviceDescriptionService");
rj(this)};DE.prototype.fa=function(){return"mr.dial.DeviceDescriptionService"};DE.prototype.qa=function(){return[Array.from(this.a)]};DE.prototype.va=function(){var a=oj(this);if(a)for(var a=ja(a),b=a.next();!b.done;b=a.next()){var c=ja(b.value),b=c.next().value,c=c.next().value;null!=zE(AE(c))?this.l.error("Dropping invalid description "+b+" loaded from storage."):this.a.set(b,AE(c))}};
var FE=function(a,b){var c;if(c=a.a.get(b.deviceLabel)){if(c.a!=b.configId||Date.now()>=c.expireTimeMillis)z(a.l,"Removing invalid entry "+c.toString()),a.a.delete(b.deviceLabel),c=null}else c=null;return c?($h("MediaRouter.Dial.Device.Description.Cached"),Promise.resolve(c)):EE(a,b)},GE=function(a,b){var c=a.b.get(b);c&&(a.h.abort(b,!0),c.ra.b(Error("Aborted")))},EE=function(a,b){if(!HE(b.deviceDescriptionUrl))return Promise.reject(Error("Invalid device description URL: "+b.deviceDescriptionUrl));
var c=a.b.get(b.deviceLabel);if(c){if(c.deviceDescriptionUrl==b.deviceDescriptionUrl)return c.ra.a;GE(a,b.deviceLabel)}var d=new Nc,c={deviceDescriptionUrl:b.deviceDescriptionUrl,ra:d};a.b.set(b.deviceLabel,c);chrome.dial.fetchDeviceDescription?chrome.dial.fetchDeviceDescription(b.deviceLabel,function(c){a.b.delete(b.deviceLabel);c?(c=IE(a,b,c.deviceDescription,c.appUrl))?d.resolve(c):d.b(Error("Failed to process fetch result")):d.b(chrome.runtime.lastError&&chrome.runtime.lastError.message?Error("chrome.dial.fetchDeviceDescription failed, chrome.runtime.lastError: "+
chrome.runtime.lastError.message):Error("chrome.dial.fetchDeviceDescription failed, chrome.runtime.lastError: Unknown error"))}):a.h.send(b.deviceLabel,b.deviceDescriptionUrl,"GET",null,null,0,function(c){a.b.delete(b.deviceLabel);var e=c.target;Ye(a.l,"fetchDeviceDescription",e);We(e)?(c=Xe(e))?(e=e.getResponseHeader("Application-URL"))?c=IE(a,b,c,e):(x(a.l,"Invalid or empty AppURL"),lE(2),c=null):(x(a.l,"Invalid or empty response"),lE(2),c=null):(x(a.l,"Request to "+String(e.u)+" failed"),lE(0),
c=null);c?d.resolve(c):d.b(Error("Failed to get device description"))});return d.a},IE=function(a,b,c,d){c=JE(a,b,c,d);if(!c)return lE(1),x(a.l,"Invalid device description"),null;x(a.l,"Got device description for "+c.deviceLabel);z(a.l,"... device description was: "+c.toString());null!=c.a&&(z(a.l,"Caching device description for "+c.deviceLabel),a.a.set(b.deviceLabel,c));return c},JE=function(a,b,c,d){var e=$e(c);if(!e)return null;var f=new yE;f.fetchTimeMillis=Date.now();f.expireTimeMillis=f.fetchTimeMillis+
18E5;f.deviceLabel=b.deviceLabel;f.a=b.configId;b=JD(b.deviceDescriptionUrl);f.ipAddress=b.hostname;f.deviceType=KE(e,"deviceType");f.modelName=KE(e,"modelName");f.friendlyName=KE(e,"friendlyName");f.uniqueId=KE(e,"UDN");!f.friendlyName&&f.modelName&&(f.friendlyName=f.modelName,f.uniqueId&&(f.friendlyName+="["+f.uniqueId.slice(-4)+"]"),w(a.l,"Fixed device description: created friendlyName from modelName."));f.appUrl=d;d=zE(f);z(a.l,function(){return"Device description: "+LE(e)});return d?(w(a.l,function(){return"Device description failed to validate: "+
f},d),null):f},KE=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},LE=function(a){var b=function(a){for(var b=0,c=a.length;b<c;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)},ME=function(a,b){var c=a.f.get(b);if(c)return c.a;c=new Nc;a.f.set(b,c);a.g.send(b,b,"GET",null,null,0,function(d){a.f.delete(b);d=d.target;Ye(a.l,"checkAccess",d,!1);c.resolve(We(d))});
return c.a},HE=function(a){a=JD(a);var b;if(b="http:"==a.protocol)a:{b:if((a=a.hostname.match(GD))&&5==a.length){b=[];for(var c=0;4>c;c++)if(b[c]=Number.parseInt(a[c+1],10),0>b[c]||255<b[c]){a=null;break b}a=b}else a=null;if(a)for(a=(a[0]<<24|a[1]<<16|a[2]<<8|a[0])>>>0,b=0;3>b;b++)if((a&HD[b])>>>0==ID[b]){b=!0;break a}b=!1}return b},BE=null,CE=null;var NE=null,OE=null,PE=function(){NE||(NE=new Ik(3,"dial.DialOnDeviceListEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onDeviceList));OE||(OE=new Ik(4,"dial.DialOnErrorEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onError));return[NE,OE]};var QE=function(a,b){b=void 0===b?new DE:b;this.f=a;this.m=b;this.l=v("mr.dial.SinkDiscoveryService");this.a=new Map;this.g=this.j=!1;this.b={wc:0,Lc:0};this.h=0};ka(QE,ui);QE.prototype.init=function(){rj(this);Ei("mr.dial.SinkDiscoveryService",this)};QE.prototype.start=function(){this.j||(x(this.l,"Starting..."),this.j=!0,PE().forEach(function(a){return a.addListener()}),RE(this))};var RE=function(a){a.j?chrome.dial.discoverNow(function(b){x(a.l,"chrome.dial.discoverNow = "+b)}):x(a.l,"Not started. Ignoring discover().")};
QE.prototype.w=function(a){var b=this;x(this.l,"onDeviceList returned "+a.length+" devices");z(this.l,function(){return"....the list is: "+JSON.stringify(a)});this.g=!1;var c=0,d=[],e=new Set;a.forEach(function(a){d.push(SE(b,a).then(function(a){e.add(a.getId());TE(b,a)},function(){c++}))});Ok(d).then(function(){b.g||UE(b,e).then(function(){var a=b.a.size;VE(b,a,a+c)})})};
var VE=function(a,b,c){a.b={wc:b,Lc:c};36E5>Date.now()-a.h||(b=a.b,bi("MediaRouter.Dial.AvailableDevicesCount",b.wc),bi("MediaRouter.Dial.KnownDevicesCount",b.Lc),a.h=Date.now())},TE=function(a,b){if(!a.g){z(a.l,"mayAddSink, id = "+b.getId());var c=a.a.get(b.getId());c?c.update(b)&&(z(a.l,"Updated sink "+c.getId()),a.f.Nc(c)):(z(a.l,function(){return"Adding new sink "+b.getId()+": "+("name = "+b.ab.friendlyName+(b.gb?", ip = "+b.gb:"")+(b.hb?", model = "+b.hb:"")+", apps = "+JSON.stringify(b.eb))}),
a.a.set(b.getId(),b),a.f.wd(b))}},UE=function(a,b){var c=[],d=[];a.a.forEach(function(e){b.has(e.getId())||d.push((e.Gb?ME(a.m,e.Gb):Promise.resolve(!1)).then(function(b){b||(a.a.delete(e.getId()),c.push(e))}))});return Ok(d).then(function(){0<c.length&&a.f.Oc(c)})},SE=function(a,b){return FE(a.m,b).then(function(a){var c;a.uniqueId?(c=a.uniqueId,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=c;c=a.uniqueId?ok(nk.U(),e):b.deviceLabel;var f=WE.test(a.modelName),
e=new qk(a.friendlyName,e);e.ab.id=c;e.gb=a.ipAddress;e.Sb=a.appUrl;e.Gb=b.deviceDescriptionUrl;e.hb=a.modelName;e.ac=!f;return e})};
QE.prototype.v=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":w(this.l,"DIAL error: "+a.code+". Clear device list now.");a=Array.from(this.a.values());this.a.clear();this.f.Oc(a);VE(this,0,0);this.g=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":w(this.l,"DIAL error: "+a.code+". Keep device list.");break;default:w(this.l,"Unhandled DIAL error: "+a.code)}};
var XE=function(a,b){return a.a.get(b)||null},ZE=function(a,b){var c=[];a.a.forEach(function(a){"available"==rk(a,b)&&c.push(a.ab)});a=YE[b];return new fo(c,a?[a]:void 0)};h=QE.prototype;h.Rg=function(){return this.b};h.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.dial.onDeviceList)this.w.apply(this,[].concat(la(c)));else if(a==chrome.dial.onError)this.v.apply(this,[].concat(la(c)));else throw Error("Unhandled event");};h.fa=function(){return"dial.DialSinkDiscoveryService"};
h.qa=function(){return[new $E(Array.from(this.a),this.b),{deviceCountMetricsRecordTime:this.h}]};h.va=function(){var a=oj(this);if(a){for(var b=ja(a.sinks),c=b.next();!c.done;c=b.next())c=c.value,this.a.set(c[0],sk(c[1]));this.b=a.deviceCounts}if(a=pj(this))this.h=a.deviceCountMetricsRecordTime};
var YE={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"},WE=/Eureka Dongle|Chromecast Audio/i,$E=function(a,b){this.sinks=a;this.deviceCounts=b};var aF=function(a,b){this.l=v("mr.dial.AppDiscoveryService");this.a=new Set;this.b=a;this.j=b;this.g=new Map;this.m=new Map;this.f=null;this.h=!1};aF.prototype.init=function(){rj(this)};aF.prototype.start=function(){x(this.l,"Starting periodic scanning.");this.h||(this.h=!0,bF(this))};aF.prototype.stop=function(){x(this.l,"Stopping periodic scanning.");this.h&&(this.h=!1,this.f&&(clearTimeout(this.f),this.f=null),this.g.clear())};
var bF=function(a){x(a.l,"Start app status scan.");var b=[];Array.from(a.b.a.values()).forEach(function(c){b.push.apply(b,cF(a,c))});Array.from(a.j.a.values()).forEach(function(c){b.push(dF(a,c))});Ok(b).then(function(){a.h&&!a.f&&(z(a.l,"Scan complete; scheduling for next scan."),a.f=setTimeout(function(){z(a.l,"Start app status scan (timer-based)");a.f=null;bF(a)},6E4))})},cF=function(a,b){if(!b.ac)return[];for(var c=[],d=ja(a.a),e=d.next();!e.done;e=d.next())c.push(a.w(e.value,b));return c};
aF.prototype.w=function(a,b){var c=this;if("unknown"!=rk(b,a)&&36E5>Date.now()-(b.Sd[a]||0)||!b.ac)return Promise.resolve();z(this.l,"Querying "+b.getId()+" for "+a+" to update app status");return eF(this,b,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}fF(c,b,a,d)},function(d){d instanceof
PD?fF(c,b,a,"unavailable"):(w(c.l,"Failed to process app availability; "+b.getId()+" does not support app availability"),b.ac=!1)})};
var dF=function(a,b){var c=XE(a.b,b.qb.sinkId);if(!c)return w(a.l,"Activity refers to nonexistent sink: "+b.qb.id),Promise.resolve();if(!c.ac)return Promise.resolve();var d=b.appName;z(a.l,"Querying "+c.getId()+" for "+d+" to update activity");return eF(a,c,d).then(function(b){"running"!=b.state&&gF(a,c,d)},function(){return gF(a,c,d)})},hF=function(a,b){var c=a.m.get(b.getId());c||(c=new RD(b),z(a.l,"Created DIAL client for "+b.getId()),a.m.set(b.getId(),c));return c},eF=function(a,b,c){var d=iF(b,
c),e=a.g.get(d);if(e)return e;e=VD(hF(a,b),c);a.g.set(d,e);b=function(){a.g.delete(d)};e.then(b,b);return e},iF=function(a,b){return a.getId()+":"+b},fF=function(a,b,c,d){z(a.l,"Got app status "+d+" from "+b.getId()+" for "+c);var e=rk(b,c);b.eb[c]=d;b.Sd[c]=Date.now();d!=e&&a.b.f.Nc(b)},gF=function(a,b,c){(b=eE(a.j,b.getId()))&&b.appName==c&&gE(a.j,b.qb.id)},jF=function(a,b){return Array.from(a.b.a.values()).some(function(a){return"unknown"==rk(a,b)})};aF.prototype.fa=function(){return"dial.AppDiscoveryService"};
aF.prototype.qa=function(){return[Array.from(this.a)]};aF.prototype.va=function(){var a=oj(this);this.a=new Set(a||[])};var kF=function(a,b,c){this.h=a;this.a=b||new QE(this);this.b=new cE(this);this.f=c||new aF(this.a,this.b);this.l=v("mr.DialProvider")};h=kF.prototype;h.getName=function(){return"dial"};h.Ga=function(){this.b.init();this.a.init();this.a.start();this.f.init();dE(this)};h.ld=function(a){z(this.l,"GetAvailableSinks for "+a);return(a=YD(a))?ZE(this.a,a.appName):go};
h.startObservingMediaSinks=function(a){var b=YD(a);if(b){a=this.f;b=b.appName;if(!a.a.has(b)||jF(a,b))a.a.add(b),0!=a.b.a.size&&(a.h?Array.from(a.b.a.values()).forEach(a.w.bind(a,b)):a.start());dE(this)}};h.stopObservingMediaSinks=function(a){if(a=YD(a))this.f.a.delete(a.appName),lF(this)};h.startObservingMediaRoutes=function(){dE(this)};h.stopObservingMediaRoutes=function(){lF(this)};
var lF=function(a){(0==a.a.a.size||0==a.f.a.size&&0==a.b.a.size)&&a.f.stop()},dE=function(a){0<a.a.a.size&&(0<a.f.a.size||0<a.b.a.size)&&a.f.start()};h=kF.prototype;h.vd=function(a){return(a=XE(this.a,a))?a.ab:null};h.hc=function(){return hE(this.b)};
h.createRoute=function(a,b,c,d){var e=this,f=XE(this.a,b);if(!f)return kE(0),Eh(Error("Unkown sink: "+b));nk.U().b=new mk(f.hb,f.Da());var g=YD(a);if(!g)return Eh(Error("No app name set."));var m=g.appName,q=new RD(f);return Fh(VD(q,m).then(function(a){if("running"==a.state)return UD(q,m)}).then(function(){return q.launchApp(m,g.launchParameter)}).then(function(){return mF(e,b,a,m,c,d)}).catch(function(a){kE(3);throw a;}))};h.joinRoute=function(){return Eh(Error("Not supported"))};
h.connectRouteByRouteId=function(){return Eh(Error("Not supported"))};h.detachRoute=function(){};var mF=function(a,b,c,d,e,f){kE(1);b=Jj(e,a.getName(),b,c,!0,d,null);b.offTheRecord=f;a.b.add(new bE(b,d));return b};kF.prototype.wd=function(a){this.h.onSinkAvailabilityUpdated(this,1);dE(this);cF(this.f,a);this.h.Cb();nk.U().a=new mk(a.hb,a.Da())};
kF.prototype.Oc=function(a){var b=this;if(0==this.a.a.size)this.h.onSinkAvailabilityUpdated(this,0);lF(this);a.forEach(function(a){var c=b.b;a=a.getId();if(a=eE(c,a))c.a.delete(a.qb.id),fE(c.b,a)});this.h.Cb()};kF.prototype.Nc=function(){this.h.Cb()};var fE=function(a,b){b=b.qb;if(b.isLocal)a.h.onPresentationConnectionStateChanged(b.id,"terminated");lF(a);a.h.Qc(a,b)};h=kF.prototype;
h.terminateRoute=function(a){var b=this.b.a.get(a)||null;if(!b)return Promise.reject(new eo(3,"Route in DIAL provider not found for routeId "+a));gE(this.b,a);return(a=XE(this.a,b.qb.sinkId))?UD(new RD(a),b.appName):Promise.reject(new eo(3,"Sink in DIAL provider not found for sinkId "+b.qb.sinkId))};h.Fc=function(){return null};h.Ec=function(){return null};h.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};
h.gd=function(a,b){b=XE(this.a,b);return!b||qi(a)?!1:(a=YD(a))?"available"==rk(b,a.appName):!1};h.xc=function(){return!1};h.searchSinks=function(){return ho()};h.createMediaRouteController=function(){return ho()};h.setMediaRouteStatusObserver=function(){};var nF=function(a,b){this.f=a;this.b=b;this.a=this.f.a;this.l=v("mr.cast.CastDialSinkDiscoveryCallbacks")},oF=function(a,b){var c=a.a.b(b.getId());if(c)return c;(b=b.Da())?(a=a.a,c=nk.U().f||8009,a=a.m.get(b+":"+c)):a=null;return a};nF.prototype.wd=function(a){oF(this,a)?Gk(2):pF(this,a);this.b.wd(a)};var pF=function(a,b){var c=vk(b);c&&Xk(a.a,c).then(function(d){d?oF(a,b)?Gk(2):(Yk(a.a,c),Gk(0)):$h("MediaRouter.Dial.Sink.Discovered.NonCast")},pa)};
nF.prototype.Oc=function(a){var b=this;t(a,function(a){var c=b.a.b(a.getId());c&&c.Ub&&Zk(b.a,a.getId())});this.b.Oc(a)};nF.prototype.Nc=function(a){var b=this.a.b(a.getId());b?b.Ub&&(b.update(a.ab.friendlyName,a.Da(),b.ua(),b.a)&&x(this.l,"Updated Cast sink with DIAL sink: "+a.getId()),al(this.a.h,b)):pF(this,a);this.b.Nc(a)};var qF=function(a,b){this.m=new QE(new nF(b,this));this.f=new C;this.b=a;this.j=this.g=0;this.h=new mf;this.a=new kF(this,this.m)};h=qF.prototype;h.fa=function(){return"cast.DialProviderWrapper"};h.qa=function(){return[new rF(Ue(this.f),this.g,this.j,this.h.P())]};h.va=function(){var a=oj(this);a&&(Qe(this.f,a.b),this.g=a.sequenceNumber,this.j=a.f,lf(this.h,a.a))};h.getName=function(){return this.a.getName()};h.Ga=function(){this.a.Ga();rj(this)};h.hc=function(){return this.a.hc()};h.vh=function(){};
h.ld=function(a){return this.a.ld(a)};h.startObservingMediaSinks=function(a){this.a.startObservingMediaSinks(a)};h.stopObservingMediaSinks=function(a){this.a.stopObservingMediaSinks(a)};h.startObservingMediaRoutes=function(a){this.a.startObservingMediaRoutes(a)};h.stopObservingMediaRoutes=function(a){this.a.stopObservingMediaRoutes(a)};h.vd=function(a){return this.a.vd(a)};
var tF=function(a,b,c,d,e){var f=YD(b),g=XE(a.m,c);if(!g)return Promise.reject(Error("Attempting custom launch with closed route"));var m=f.appName;if(!m)return Promise.reject(Error("No app name given"));var q=Hm(b);return q?VD(new RD(g),m).then(function(y){var D=mF(a.a,c,b,m,e,d);y={routeId:D.id,sinkId:g.getId(),appName:m,xg:y,launchParameter:f.launchParameter,session:null,clientId:null};a.f.set(D.id,y);var V=sF(a,y.sinkId),fa=new am("receiver_action",{receiver:V,action:chrome.cast.ed.CAST});fa.clientId=
q;a.b.Kb(a,y.routeId,fa);var fa=chrome.cast.L,xa=String(a.j);a.j=(a.j+1)%9007199254740992;V=new fa(xa,"",y.appName,[],V);y.session=V;y.clientId=q;V=new am("new_session",V);V.clientId=q;a.b.Kb(a,y.routeId,V);return D}):Promise.reject(Error("No client ID"))};qF.prototype.createRoute=function(a,b,c,d,e,f,g){return uF.test(a)?Fh(tF(this,a,b,d,c)):this.a.createRoute(a,b,c,d,e,f,g)};
qF.prototype.terminateRoute=function(a){var b=this.f.get(a);if(b&&b.session&&b.clientId){var c={receiver:sF(this,b.sinkId),action:chrome.cast.ed.STOP},c=new am("receiver_action",c);c.clientId=b.clientId;this.b.Kb(this,b.routeId,c);this.b.onPresentationConnectionStateChanged(b.routeId,"terminated")}return this.a.terminateRoute(a)};
qF.prototype.sendRouteMessage=function(a,b,c){var d=JSON.parse(b);switch(d.type){case "client_connect":return b=d.clientId,(a=this.f.get(a))?(c=sF(this,a.sinkId),c.receiverType=chrome.cast.Rd.DIAL,c=new am("custom_dial_launch",new chrome.cast.eg(c,a.xg.state,a.xg.extraData)),c.clientId=b,b=this.g,this.g=(this.g+1)%9007199254740992,c.sequenceNumber=b,this.h.add(c.sequenceNumber),this.b.Kb(this,a.routeId,c),a=Promise.resolve()):a=Promise.reject(Error("Unknown route")),a;case "custom_dial_launch":if(this.h.contains(d.sequenceNumber))return this.h.remove(d.sequenceNumber),
b=d.message,(a=this.f.get(a))?b&&!b.doLaunch?a=Promise.resolve():(c=XE(this.m,a.sinkId))?(c=new RD(c),d=a.launchParameter,d=(b?b.launchParameter:null)||d,a=c.launchApp(a.appName,d)):a=Promise.reject(Error("Custom launch response for sink that no longer exists")):a=Promise.reject(Error("Unknown route")),a;break;case "v2_message":if("STOP"==d.message.type)return this.terminateRoute(a),Promise.resolve()}return this.a.sendRouteMessage(a,b,c)};
qF.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};var sF=function(a,b){a=XE(a.m,b);b=new chrome.cast.Le(b,a.ab.friendlyName);b.ipAddress=a.Da();b.receiverType=chrome.cast.Rd.DIAL;return b};h=qF.prototype;h.Fc=function(a){return this.a.Fc(a)};h.Ec=function(a){return this.a.Ec(a)};h.gd=function(a,b){return this.a.gd(a,b)};h.xc=function(a,b,c){return this.a.xc(a,b,c)};
h.connectRouteByRouteId=function(a,b,c,d,e){return this.a.connectRouteByRouteId(a,b,c,d,e)};h.joinRoute=function(a,b,c,d,e,f){return this.a.joinRoute(a,b,c,d,e,f)};h.detachRoute=function(a){this.f.remove(a);this.a.detachRoute(a)};h.Cb=function(){this.b.Cb()};h.onSinkAvailabilityUpdated=function(a,b){this.b.onSinkAvailabilityUpdated(a,b)};h.kc=function(a,b){this.b.kc(this,b)};h.Qc=function(a,b){this.b.Qc(this,b)};h.Wb=function(a,b){this.b.Wb(this,b)};h.Kb=function(a,b,c){this.b.Kb(this,b,c)};
h.onPresentationConnectionStateChanged=function(a,b){this.b.onPresentationConnectionStateChanged(a,b)};h.onPresentationConnectionClosed=function(a,b,c){this.b.onPresentationConnectionClosed(a,b,c)};h.af=function(a){return this.b.af(a)};h.df=function(){return this.b.df()};h.Pc=function(){return this.b.Pc()};h.qe=function(a,b,c){this.b.qe(this,b,c)};h.qf=function(a){this.b.qf(a)};h.wd=function(a){this.a.wd(a)};h.Oc=function(a){this.a.Oc(a)};h.Nc=function(a){this.a.Nc(a)};h.mf=function(){};h.lh=function(){};
h.searchSinks=function(a,b){return this.a.searchSinks(a,b)};h.createMediaRouteController=function(){return ho()};h.setMediaRouteStatusObserver=function(){};h.Hf=function(a){this.b.Hf(a)};h.lf=function(){return this.b.lf()};h.Tc=function(a,b){return this.b.Tc(a,b)};var rF=function(a,b,c,d){this.b=a;this.sequenceNumber=b;this.f=c;this.a=d},uF=/__dialAppName__/;var yF=function(a,b){this.j=a;this.m=b;this.g=new Nc;this.a=this.g.a;this.h=sp(a.id);this.b=new Nc;this.f=!1;vF(this);wF(this);xF(this,new Xi("GET_TURN_CREDENTIALS"))};yF.prototype.start=function(){var a=this;return this.a.then(function(b){if(b.b)return Promise.reject(Error("Presentation already started"));b.start();return a.b.a})};yF.prototype.stop=function(){var a=this;this.f=!1;return this.a.then(function(b){b.stop();a.a=Promise.reject(Error("Peer connection has already been stopped"))})};
var vF=function(a){a.h.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.g.resolve(new bj(a.j.id,b.data.credentials));break;case "ANSWER":a.a.then(function(a){jj(a,b.data)});break;case "STOP":a.b.b("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.a.then(function(a){var c={type:"PRESENTATION_CONNECTION_MESSAGE",data:b};"string"==typeof c?a.g.send(c):a.g.send(JSON.stringify(c))})}},wF=function(a){a.a.then(function(b){fj(b,function(b){xF(a,
new Xi("OFFER",new Zi(b,null,null,a.m)))});gj(b,function(b){b=Yi(b);"STOP"==b.type&&a.stop();xF(a,b)});cj(b,function(){a.f=!0;xF(a,new Xi("SESSION_START_SUCCESS"));a.b.resolve(a.j)});ej(b,function(){xF(a,new Xi("SESSION_END"))});dj(b,function(b){a.f||a.b.b(b);xF(a,new Xi("SESSION_FAILURE"))})})},xF=function(a,b){a.h.sendMessage(b,zF)},zF={channelType:"cloud"};var AF=function(a){this.a=a;this.f=new Map;this.A=new Map;this.o=[];this.g=this.J=this.v=this.B=this.j=null;this.m=this.h=this.b=!1;this.u=new Map;this.w=new Map;rj(this)};AF.prototype.getName=function(){return"cloud"};
AF.prototype.Ga=function(){var a=this;x(this.l,"Initializing Cloud MRP");var b=AD.U();null==b.g&&(null==b.h&&(b.h=new Sq(ED(b))),b.g=new zw(b.h,this));this.o.push(b.g);if(null==b.j){var c;null==b.f&&(b.f=new Ds(ED(b),CD(b)));c=b.f;null==b.m&&(b.m=new Js(ED(b)));b.j=new xD(c,b.m,this,DD(b))}this.j=b.j;this.o.push(this.j);this.B=FD(b);this.v=CD(b);if(null==b.B){if(null==b.w){c=FD(b);var d=CD(b);null==b.F&&(b.F=new hz(ED(b)));b.w=new rt(c,d,b.F,this)}c=b.w;null==b.A&&(b.A=new xt(CD(b),this));b.B=new zt(c,
b.A,this)}this.J=b.B;null==b.J&&(b.J=new dr);this.g=b.J;kr(this.g).then(function(b){a.b=b;x(a.l,"Cloud enabled setting: "+a.b)});hr(this.g).then(function(b){a.h=b;x(a.l,"Cloud on setting: "+a.h)});er(this.g,function(b){a.b=b;x(a.l,"Cloud enabled setting: "+a.b);a.b&&BF(a)});pr(this.g).then(function(b){a.m=b;x(a.l,"Privacy notified setting: "+a.m)})};AF.prototype.hc=function(){return Array.from(this.f.values())};
AF.prototype.ld=function(a){if(!CF(this,a))return go;z(this.l,"GetAvailableSinks for "+a);var b=[];if(this.h||DF())b=BF(this);this.w.clear();for(var c={},d=ja(this.u.values()),e=d.next();!e.done;c={Vc:c.Vc,ee:c.ee},e=d.next())c.Vc=e.value,c.ee=!1,b.forEach(function(a){return function(b){b.wa.id==a.Vc.wa.id&&(a.ee=!0,b.wa.friendlyName=a.Vc.wa.friendlyName)}}(c)),c.ee||this.w.set(c.Vc.wa.id,c.Vc);b=b.concat.apply(b,[].concat(la(this.w.values())));z(this.l,function(){return"Available sinks are..."+JSON.stringify(b)});
c=b.map(function(a){return a.wa});this.j&&(c=c.concat(EF));return new fo(c,-1!=a.indexOf("0F5096E8")?si:null)};var BF=function(a){var b=[];x(a.l,"Checking cloud discovery services");nk.U().h=Ea();a.o.forEach(function(a){a=a.Rc();b=b.concat(a)});return b};h=AF.prototype;h.startObservingMediaSinks=function(){};h.stopObservingMediaSinks=function(){};h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.vd=function(a){return(a=FF(this,a))?a.wa:null};
h.createRoute=function(a,b,c,d,e,f,g){var m=this;x(this.l,"createRoute called");z(this.l,"urn: "+a+" sinkId:"+b);if(e=this.A.get(b))return Bh(this.a.lh(this,e,a,c,g,function(b){b.mediaSource=a;b.pb.tabId=g;return Dh(b)}),function(a){m.a.Wb(m,a);return a});e=FF(this,b);return GF(this,a,e,b,c,d,g)};
var HF=function(a,b,c,d,e){b instanceof eo&&2==b.errorCode?a.uc(c,6,null):(a.l.error("Error on start session",b instanceof Error?b:Error("Expected an Error value, got "+b)),a.uc(c,e,new zh(vs,"warning","dismiss")));if(b=a.j)b=a.j,b.b.delete(d.deviceId)?(b.a.a.delete(d.wa.id),b=!0):b=!1;b&&a.oe([d.wa])},GF=function(a,b,c,d,e,f,g){if(f)return Eh(Error("not supported"));f=!1;switch(IF(c)){case "cloud":vq(1);break;case "mesi":f=!0;if(!a.m){a.m=!0;nr(a.g);var m=new zh(ys,"notification","learn_more");m.secondaryActions=
["dismiss"];m.helpPageId=6320939;a.a.Pc().send(m)}vq(0)}nk.U().b=new mk(c.model,null);var q=Jj(e,a.getName(),d,b,!0,"",null);f&&(q.customControllerPath="cloud_route_details/view.html?routeId="+q.id);a.f.set(q.id,q);a.A.set(d,q);a.u.set(q.id,c);a.a.kc(a,q);a.a.Tc(a.fa(),!0);if(ri(b)&&!f)return x(a.l,"starting presentation on route: "+q.id),Ch(JF(q,b),function(b){HF(a,b,q,c,7);throw b;});x(a.l,"starting mirroring on route: "+q.id);q.pb={tabId:g,sessionId:"",Pf:"",ji:c.model};ri(b)&&(q.isOffscreenPresentation=
!0);return Ch(a.a.mf(a,q,e),function(b){HF(a,b,q,c,5);throw b;})};h=AF.prototype;h.terminateRoute=function(a){var b=this.f.get(a);return b?this.uc(b,0,null):Promise.reject(new eo(3,"Route in cloud provider not found for routeId "+a))};
h.uc=function(a,b,c){x(this.l,"terminating route: "+a.id);this.f.delete(a.id);this.A.delete(a.sinkId);var d=this.u.get(a.id);this.u.delete(a.id);c&&this.mh().send(c);ai("MediaRouter.Cloud.Session.End",b,qq);switch(b){case 1:break;default:switch(IF(d)){case "cloud":Hq(this.B,d.deviceId,Rp,{})}}this.a.Qc(this,a);0==this.f.size&&this.a.Tc(this.fa(),!1);this.a.onPresentationConnectionStateChanged(a.id,"terminated");this.w.has(a.sinkId)&&(b=this.w.get(a.sinkId),this.oe([b.wa]),this.w.delete(a.sinkId));
return Promise.resolve()};h.sendRouteMessage=function(a,b,c){if(c&&c.channelType){c=c.channelType;var d=(a=this.f.get(a)||void 0)?FF(this,a.sinkId):void 0;return At(this.J,c,b,a,d)}return va(b)?(this.kb(b,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
h.Fc=function(a){var b=new Vi;"hangouts"!=this.Ec(a)&&(b.senderSideLetterboxing=!0);Wi(b);Object.freeze(b);x(this.l,"Settings for "+a+": "+Ui(b));return b.shouldCaptureAudio||b.shouldCaptureVideo?b:null};h.Ec=function(a){var b=null;a=FF(this,a);switch(IF(a)){case "cloud":b="webrtc";break;case "mesi":b=a.vb?"meetings":"hangouts"}return b};h.gd=function(a,b){z(this.l,"Checking canRoute: "+a+" for sinkId: "+b);return CF(this,a)&&!!this.vd(b)};
h.xc=function(a,b){return"https://hangouts.google.com/cloudmrp-mirroring"==a&&this.f.has(b)};h.joinRoute=function(a,b){return(a=this.f.get(b))?Dh(a):Eh(Error("not supported"))};h.connectRouteByRouteId=function(){return Eh(Error("not supported"))};h.detachRoute=function(){};h.rf=function(a){x(this.l,a.length+" sinks added");0<a.length&&!this.h&&(fr(this.g),this.h=!0);a=FF(this,a[0].id);nk.U().a=new mk(a.model,null);this.a.Cb();this.a.onSinkAvailabilityUpdated(this,2);x(this.l,"sinkAvailability changed to AVAILABLE")};
h.oe=function(a){x(this.l,a.length+" sinks removed");this.o.some(function(a){return 0<a.Rc().length})||(this.a.onSinkAvailabilityUpdated(this,0),x(this.l,"sinkAvailability changed to UNAVAILABLE"));this.a.Cb()};h.nh=function(a){x(this.l,a.length+" sinks updated");this.a.Cb()};h.mh=function(){return this.a.Pc()};h.kb=function(a,b,c){c?this.a.Kb(this,b,a):this.a.qe(this,b,a)};
var FF=function(a,b){var c=KF(a,b);c||(c=null,(b=a.A.get(b))&&(c=a.u.get(b.id)));return c},KF=function(a,b){var c=null;a.o.some(function(a){c=a.ic(b);return!!c});return c},IF=function(a){return Kb(a.a,"cloud")?"cloud":Kb(a.a,"mesi")?"mesi":null},DF=function(){var a=nk.U().h;return 3E5<=Date.now()-a},CF=function(a,b){var c=qi(b);b=ri(b);if(a.v.f&&!a.v.b&&c)return a.a.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.b&&a.v.b&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.v,e=!(a.f||a.b&&a.a&&(-1!=
cr.indexOf(a.a)||-1!=cr.indexOf($q(a))))&&b;return e?!1:d&&(c||b)};h=AF.prototype;h.searchSinks=function(a,b){var c=this;if(!CF(this,a))return Promise.reject(Error("err"));a=zD(this.j,b);a.then(function(a){c.rf([a])});return a};h.createMediaRouteController=function(){return ho()};h.setMediaRouteStatusObserver=function(){};h.fa=function(){return"CloudProvider"};h.qa=function(){return[void 0,{cloudEnabled:this.b,cloudOn:this.h,notifiedHangoutsPrivacy:this.m}]};
h.va=function(){var a=pj(this);a&&(a.cloudEnabled&&(this.b=a.cloudEnabled),a.cloudOn&&(this.h=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.m=a.notifiedHangoutsPrivacy))};var JF=function(a,b){a=new yF(a,b);return Fh(a.start())};AF.prototype.l=v("mr.CloudProvider");var EF=new Wj("pseudo:cloud","","meeting","","default");var LF=function(){Ik.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};ka(LF,Ik);LF.prototype.Fe=function(a,b){return b.id&&-1!=MF.indexOf(b.id)?"start"==a.type||"stop"==a.type:!1};LF.prototype.We=function(){return!0};var OF=function(){NF||(NF=new LF);return NF},NF=null,MF=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var PF=function(){Ik.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};ka(PF,Ik);PF.prototype.Fe=function(a,b){return"retrieve_log_data"==a.type&&b.id==chrome.runtime.id&&b.url=="chrome-extension://"+b.id+"/feedback.html"};PF.prototype.We=function(){return!0};var RF=function(){QF||(QF=new PF);return QF},QF=null;var SF,TF,UF=v("mr.Init"),VF=function(){var a=TF,b=new xo(a),c=new qF(a,b),b=[b,c];b.push(new AF(a));return b};fp.U().init();SF=new Vh("MediaRouter.Provider.WakeDuration");TF=new tp;
var WF=(new Promise(function(a,b){switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(c){chrome.runtime.lastError||!c.enabled?a():b(Error("Dev extension is enabled"))});break;default:b(Error("Unknown extension id"))}})).then(function(){return chrome.mojoPrivate&&chrome.mojoPrivate.requireAsync?new Promise(function(a){chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.gk&&b.gk();
b.start().then(function(c){a({mrService:b,mrInstanceId:c})})})}):Promise.reject(Error("No mojo service loaded"))}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");x(UF,"MR instance ID: "+b);a=a.mrService;if(!TF)throw Error("providerManager not initialized.");a.setHandlers(TF);tj(b)&&(SF.b="MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(SF.a.bind(SF));xj(b);ip();b=VF();window.addEventListener("unhandledrejection",
function(a){a=a.reason;a.stack||(a=Error(a));UF.error("Unhandled promise rejection.",a)});TF.Ga(a,b)}).then(void 0,function(a){w(UF,a.message);throw a;});[].concat([OF(),RF()],la(PE()),la([Lk(),Nk()]),la([Kr()])).forEach(function(a){rj(a)});OF().addListener();RF().addListener();WF.then(void 0,function(){return window.close()});
